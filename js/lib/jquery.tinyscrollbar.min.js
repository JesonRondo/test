(function($){$.tiny=$.tiny||{};$.tiny.scrollbar={options:{axis:'y',wheel:40,scroll:true,lockscroll:true,size:'auto',sizethumb:'auto',invertscroll:false}};$.fn.tinyscrollbar=function(a){var b=$.extend({},$.tiny.scrollbar.options,a);this.each(function(){$(this).data('tsb',new Scrollbar($(this),b))});return this};$.fn.tinyscrollbar_update=function(a){return $(this).data('tsb').update(a)};function Scrollbar(d,e){var f=this,oWrapper=d,oViewport={obj:$('.viewport',d)},oContent={obj:$('.overview',d)},oScrollbar={obj:$('.scrollbar',d)},oTrack={obj:$('.track',oScrollbar.obj)},oThumb={obj:$('.thumb',oScrollbar.obj)},sAxis=e.axis==='x',sDirection=sAxis?'left':'top',sSize=sAxis?'Width':'Height',iScroll=0,iPosition={start:0,now:0},iMouse={},touchEvents='ontouchstart'in document.documentElement;function initialize(){f.update();setEvents();return f}this.update=function(a){oViewport[e.axis]=oViewport.obj[0]['offset'+sSize];oContent[e.axis]=oContent.obj[0]['scroll'+sSize];oContent.ratio=oViewport[e.axis]/oContent[e.axis];oScrollbar.obj.toggleClass('disable',oContent.ratio>=1);oTrack[e.axis]=e.size==='auto'?oViewport[e.axis]:e.size;oThumb[e.axis]=Math.min(oTrack[e.axis],Math.max(0,(e.sizethumb==='auto'?(oTrack[e.axis]*oContent.ratio):e.sizethumb)));oScrollbar.ratio=e.sizethumb==='auto'?(oContent[e.axis]/oTrack[e.axis]):(oContent[e.axis]-oViewport[e.axis])/(oTrack[e.axis]-oThumb[e.axis]);iScroll=(a==='relative'&&oContent.ratio<=1)?Math.min((oContent[e.axis]-oViewport[e.axis]),Math.max(0,iScroll)):0;iScroll=(a==='bottom'&&oContent.ratio<=1)?(oContent[e.axis]-oViewport[e.axis]):isNaN(parseInt(a,10))?iScroll:parseInt(a,10);setSize()};function setSize(){var a=sSize.toLowerCase();oThumb.obj.css(sDirection,iScroll/oScrollbar.ratio);oContent.obj.css(sDirection,-iScroll);iMouse.start=oThumb.obj.offset()[sDirection];oScrollbar.obj.css(a,oTrack[e.axis]);oTrack.obj.css(a,oTrack[e.axis]);oThumb.obj.css(a,oThumb[e.axis]);$(".bom").css({height:oThumb[e.axis]-5})}function setEvents(){if(!touchEvents){oThumb.obj.bind('mousedown',start);oTrack.obj.bind('mouseup',drag)}else{oViewport.obj[0].ontouchstart=function(a){if(1===a.touches.length){start(a.touches[0]);a.stopPropagation()}}}if(e.scroll&&window.addEventListener){oWrapper[0].addEventListener('DOMMouseScroll',wheel,false);oWrapper[0].addEventListener('mousewheel',wheel,false)}else if(e.scroll){oWrapper[0].onmousewheel=wheel}}function start(b){$("body").addClass("noSelect");var c=parseInt(oThumb.obj.css(sDirection),10);iMouse.start=sAxis?b.pageX:b.pageY;iPosition.start=c=='auto'?0:c;if(!touchEvents){$(document).bind('mousemove',drag);$(document).bind('mouseup',end);oThumb.obj.bind('mouseup',end)}else{document.ontouchmove=function(a){a.preventDefault();drag(a.touches[0])};document.ontouchend=end}}function wheel(a){if(oContent.ratio<1){var b=a||window.event,iDelta=b.wheelDelta?b.wheelDelta/120:-b.detail/3;iScroll-=iDelta*e.wheel;iScroll=Math.min((oContent[e.axis]-oViewport[e.axis]),Math.max(0,iScroll));oThumb.obj.css(sDirection,iScroll/oScrollbar.ratio);oContent.obj.css(sDirection,-iScroll);if(e.lockscroll||(iScroll!==(oContent[e.axis]-oViewport[e.axis])&&iScroll!==0)){b=$.event.fix(b);b.preventDefault()}}}function drag(a){if(oContent.ratio<1){if(e.invertscroll&&touchEvents){iPosition.now=Math.min((oTrack[e.axis]-oThumb[e.axis]),Math.max(0,(iPosition.start+(iMouse.start-(sAxis?a.pageX:a.pageY)))))}else{iPosition.now=Math.min((oTrack[e.axis]-oThumb[e.axis]),Math.max(0,(iPosition.start+((sAxis?a.pageX:a.pageY)-iMouse.start))))}iScroll=iPosition.now*oScrollbar.ratio;oContent.obj.css(sDirection,-iScroll);oThumb.obj.css(sDirection,iPosition.now)}}function end(){$("body").removeClass("noSelect");$(document).unbind('mousemove',drag);$(document).unbind('mouseup',end);oThumb.obj.unbind('mouseup',end);document.ontouchmove=document.ontouchend=null}return initialize()}}(jQuery));